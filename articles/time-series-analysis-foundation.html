<!doctype html>
<html>
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <meta name="description" content="时间序列是现实生活中经常会碰到的数据形式。例如北京市连续一年的日平均气温、某股票的股票价格、淘宝上某件商品的日销售件数等等。时间序列分析的的目的是挖掘时间序列中隐含的信息与模式，并借此对此序列数据进行评估以及对系列的后续走势进行预测。由于工作需要，我最近简单学习了时间序列分析相关的基础理论和应用方法，这篇文章可以看做是我的学习笔记。文章主要内容会首先描述时间序列分析的基本概念和相关的统计学基础理论，然后着重讲述十分经典和常用的ARIMA模型，在这之后会讲述季节ARIMA模型、干预分析和存在协变量时间序列的分析，最后讲述用于发现隐藏周期性的谱分析基础。由于打算以学习笔记的形式写这篇文章，所以我不会一下子写完整篇文章才发布，而是持续更新这篇文章，写的过程中也可能会对前面的内容进行修订。文章中会穿插许多实例（兼有模拟数据和数据分析），分析过程中将使用R为分析工具。"/>
        <meta name="keywords" content="编程,代码,计算机,数学,PHP,Nginx,数据挖掘,机器学习,算法,编译器,分布式"/>
        <meta name="author" content="张洋"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
        <title>CodingLabs - 时间序列分析基础</title>
        <link rel="stylesheet" href="/assets/vendor/normalize.css"/>
        <link rel="stylesheet" href="/assets/vendor/prettify.css"/>
        <link rel="stylesheet" href="/assets/css/simplog.css"/>
        <link rel="shortcut icon" href="/fav.ico"/>
        <script type="text/javascript" src="/assets/vendor/prettify.js"></script>
        <script type="text/javascript">
            var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
            document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F75dfda8ff8a93fa0b94adeb17da37a2f' type='text/javascript'%3E%3C/script%3E"));
        </script>
    </head>
    <body onload="prettyPrint()">
        <div id="header">
            <div id="header-inner">
                <div id="title"><a href="/"><small>{</small> CodingLabs <small>}</small></a></div>
                <div id="subtitle">/&gt; keep coding, keep foolish</div>
            </div>
        </div>
        <div id="main">
            <div id="main-inner">
                <div id="article-title">
                    <a href="/articles/time-series-analysis-foundation.html">时间序列分析基础</a>
                </div>
                <div id="article-meta">
                    作者 张洋 | 发布于 2013-05-27 | 最后更新 2013-05-29
                </div>
                <div id="article-tags">
                    <a class="tag" href="/tag.html#数据挖掘">数据挖掘</a><a class="tag" href="/tag.html#数据分析">数据分析</a><a class="tag" href="/tag.html#时间序列">时间序列</a><a class="tag" href="/tag.html#ARIMA">ARIMA</a><a class="tag" href="/tag.html#R">R</a>
                </div>
                <div id="article-content">
                    <p>时间序列是现实生活中经常会碰到的数据形式。例如北京市连续一年的日平均气温、某股票的股票价格、淘宝上某件商品的日销售件数等等。时间序列分析的的目的是挖掘时间序列中隐含的信息与模式，并借此对此序列数据进行评估以及对系列的后续走势进行预测。</p>
<p>由于工作需要，我最近简单学习了时间序列分析相关的基础理论和应用方法，这篇文章可以看做是我的学习笔记。</p>
<p>文章主要内容会首先描述时间序列分析的基本概念和相关的统计学基础理论，然后着重讲述十分经典和常用的ARIMA模型，在这之后会讲述季节ARIMA模型、干预分析和存在协变量时间序列的分析，最后讲述用于发现隐藏周期性的谱分析基础。</p>
<p>由于打算以学习笔记的形式写这篇文章，所以我不会一下子写完整篇文章才发布，而是持续更新这篇文章，写的过程中也可能会对前面的内容进行修订。</p>
<p>文章中会穿插许多实例（兼有模拟数据和数据分析），分析过程中将使用<a href="http://www.r-project.org/">R</a>为分析工具。</p>
<h1>基本概念</h1>
<h2>时间序列</h2>
<p>简单来说，时间序列是一个变量在不同时间点的值所组成的有序序列。例如北京市2013年4月每日的平均气温就构成了一个30个元素的时间序列，为了方便，我们一般认为序列中相邻元素具有相同的时间间隔。</p>
<p>时间序列可以分为确定的和随机的。例如一个1990年出生的人，从1990年到1999年年龄可以表述为\(\{0, 1, 2, \ldots , 9\}\)，这个序列并没有任何随机因素。不过现实生活中我们面对的更多的是掺杂了随机因素的时间序列，例如气温、销售量等等。</p>
<h2>时间序列分析</h2>
<p>时间序列分析说白了就是寻找时间序列中的模式。如果是在确定性时间序列中，这就基本等价于寻找序列的通项公式，例如上面年龄的时间序列，用差为1的等差数列公式就可以很好的描述其模式。</p>
<p>当然实际的时间序列分析基本都是针对随机时间序列。对于随机时间序列，情况会复杂一些，但本质上还是可以看做寻找通项公式（可以是封闭形式或递推形式），只不过我们面对的序列存在随机扰动，所以分析过程中除了确定性序列分析的技术外，还需要一些概率统计方面的知识和方法，下面一节会介绍一些相关的基础知识。</p>
<h2>主要统计量</h2>
<p>注意时间序列中的每一个元素都是一个普通的随机变量，如果忽略序列的时间性，那么我们面对的实际上是一个随机变量集合，所以从这个角度来说时间序列的统计分析与普通统计分析没有太大不同，相关的理论也是通用的。</p>
<p>对于随机变量集合来说，要完整描述其统计特性需要处理其多元联合分布，这是非常复杂的。所以实际我们往往做一些必要的简化假设，避免处理复杂的多元联合分布。</p>
<p>现假设我们有随机时间序列</p>
<p>\[\{Y_t|t=0, \pm 1, \pm 2, \cdots \}\]</p>
<p>下面先给出一些常用的统计量。后面会接着通过一些常见序列来举例说明各统计量如何计算。</p>
<h3>均值</h3>
<p>均值函数被定义为关于自变量t的函数：</p>
<p>\[\mu_t=E(Y_t)\]</p>
<p>t的均值函数值表示在t时刻随机变量\(Y_t\)的期望。</p>
<h3>方差</h3>
<p>与均值类似，方差是t时刻序列元素的方差：</p>
<p>\[\sigma^2_t=E((Y_t-\mu_t)^2)\]</p>
<h3>自协方差</h3>
<p>自协方差是一个二元函数，其自变量为两个时间点，值是两个时间点上序列值的协方差：</p>
<p>\[\gamma_{t,s}=Cov(Y_t,Y_s)=E((Y_t-\mu_t)(Y_s-\mu_s))\]</p>
<p>当t=s时，自协方差就是t时刻的方差。</p>
<h3>自相关系数</h3>
<p>自相关系数是两个时刻的值的相关系数：</p>
<p>\[\rho_{t,s}=\frac{\gamma_{t,s}}{\sqrt{\gamma_{t,t}\gamma_{s,s}}}\]</p>
<p>如果忽略元素来自时间序列这一事实，各统计量的意义实际上与普通的统计学中无异。因此这些统计量的一些性质也可以无缝推广到时间序列分析。例如期望的线性性质等等。如果有需要可以自行复习一下这些统计量的相关计算性质。后面的推导会主要集中于这几个统计量的计算。</p>
<h2>时间序列示例</h2>
<p>下面看几个简单的随机时间序列示例。</p>
<h3>白噪声</h3>
<p>考虑一个时间序列，其中每一个元素为独立同分布变量。这种时间序列叫做白噪声。之所以叫这个名字，是因为对这种序列的频域分析表明其中平等的包含了各个频率，和物理中的白光类似。</p>
<p>下面是用R模拟生成的白噪声时序图。</p>
<p class="picture"><img alt="" src="/uploads/pictures/time-series-analysis-foundation/whitenoise.png"/></p>

<pre class="prettyprint">Y = ts(rnorm(100, mean=0, sd=1));
plot(Y, family="simhei", main="白噪声", type="b", col="red");
abline(h=0)</pre>

<p>其中共100个元素，每个元素都独立服从标准正态分布\(N(0,1)\)。可以从图中看出白噪声基本是在均值附近较为平均的随机震荡。</p>
<p>由于每个元素服从\(N(0,1)\)，所以均值\(\mu_t=0\)，方差\(\sigma^2_t=1\)。又因为每个元素独立，所以对于任何\(t \neq s\)，\(\gamma_{t,s}=0\)，\(\rho_{t,s}=0\)。这些统计特征与对图像的直观观察基本一致。</p>
<h3>随机游走</h3>
<p>下面考虑这样一个时间序列，其在t时刻的值是前面白噪声序列的前t个值之和，设\(\{e_1, e_2, \ldots, e_t, \ldots \}\)为标准正态分布产生的白噪声，则：</p>
<p>\[\begin{array}{l l l}
Y_1 &amp; = &amp; e_1 \\
Y_2 &amp; = &amp; e_1+e_2 \\
&amp; \vdots &amp; \\
Y_t &amp; = &amp; e_1+e_2+\cdots +e_t \\
&amp; \vdots &amp;
\end{array}\]</p>
<p>下面是用R模拟的随机游走。</p>
<p class="picture"><img alt="" src="/uploads/pictures/time-series-analysis-foundation/randwalk.png"/></p>

<pre class="prettyprint">Y = ts(rnorm(100, mean=0, sd=1));
for (i in 2:length(Y)) {
    Y[i] = Y[i] + Y[i-1];
}
plot(Y, family="simhei", main="随机游走", type="b", col="red");
abline(h=0)</pre>

<p>可以看到随机游走比白噪声平滑很多，并且呈现出一些“趋势性”的感觉。下面分析其相关统计特征。</p>
<p>均值：\(\mu_t=E(e_1 + \cdots + e_t)=E(e_1) + \cdots + E(e_t)=0\)</p>
<p>方差：\(\sigma^2_t=Var(e_1 + \cdots + e_t)=Var(e_1) + \cdots + Var(e_t)=t\)</p>
<p>对协方差的计算需要用到一个协方差性质：</p>
<p>\[Cov(\sum_{i=1}^m{c_iY_i}, \sum_{j=1}^n{d_jY_j})=\sum_{i=1}^m{\sum_{j=1}^n{c_i d_j Cov(Y_i, Y_j)}}\]</p>
<p>设t小于s，由于只有i=j时\(Cov(Y_i, Y_j)=1\)，所以：</p>
<p>自协方差：\(\gamma_{t,s}=t\)</p>
<p>自相关系数：\(\rho_{t,s}=\frac{t}{\sqrt{ts}}=\sqrt{\farc{t}{s}}\)</p>

                </div>

<!-- UJian Button BEGIN -->
<div class="ujian-hook"></div>
<script type="text/javascript">var ujian_config = {lkrc:0};</script>
<script type="text/javascript" src="http://v1.ujian.cc/code/ujian.js?uid=894207"></script>
<a href="http://www.ujian.cc" style="border:0;"><img src="http://img.ujian.cc/pixel.png" alt="友荐云推荐" style="border:0;padding:0;margin:0;" /></a>
<!-- UJian Button END -->
<!-- JiaThis Button BEGIN -->
<div class="jiathis_style">
    <span class="jiathis_txt">分享到：</span>
    <a class="jiathis_button_qzone">QQ空间</a>
    <a class="jiathis_button_tsina">新浪微博</a>
    <a class="jiathis_button_tqq">腾讯微博</a>
    <a class="jiathis_button_renren">人人网</a>
    <a href="http://www.jiathis.com/share?uid=894207" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank">更多</a>
    <a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript">
    var jiathis_config = {data_track_clickback:'true'};
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=894207" charset="utf-8"></script>
<!-- JiaThis Button END -->
<!-- Duoshuo Comment BEGIN -->
<div class="ds-thread"></div>
<script type="text/javascript">
    var duoshuoQuery = {short_name:"coding-labs"};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = 'http://static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
</script>
<!-- Duoshuo Comment END -->
            </div>
        </div>
        <div id="footer">
            <div id="footer-inner">
                <p id="copyright">Copyright (c) 2011-2013 CodingLabs. <span id="madeonmymac" style="color:#999999;">Made on my Mac </span></p>
                <p id="icp"><a href="http://www.miibeian.gov.cn/" target="_blank">京ICP备12043064-1号</a></p>
            </div>
        </div>
        <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </body>
</html>
